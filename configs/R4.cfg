! ============================================================
! R4 - Cisco IOSv Router
! Role: Backbone Router (Area 0) & ABR to Totally Stubby Area 2
! ============================================================

version 15.9
hostname R4
no ip domain-lookup

! -------------------------
! Loopback Interface (RID)
! -------------------------
interface Loopback0
 ip address 4.4.4.4 255.255.255.255
!

! -------------------------
! Physical Interfaces
! -------------------------
interface GigabitEthernet0/0
 description Link to R3
 ip address 10.0.34.4 255.255.255.0
 no shutdown
!
interface GigabitEthernet0/1
 description Link to R2
 ip address 10.0.24.4 255.255.255.0
 no shutdown
!
interface GigabitEthernet0/2
 description Link to R6 (Area 2)
 ip address 10.2.46.4 255.255.255.0
 no shutdown
!

! -------------------------
! Prefix-list for route filtering into Area 2
! Deny route 7.7.7.7/32, allow all others
! -------------------------
ip prefix-list BLOCK-PREFIX seq 5 deny 7.7.7.7/32
ip prefix-list BLOCK-PREFIX seq 10 permit 0.0.0.0/0 le 32
!

! -------------------------
! OSPF Configuration
! -------------------------
router ospf 1
 router-id 4.4.4.4
 network 4.4.4.4 0.0.0.0 area 0
 network 10.0.0.0 0.0.255.255 area 0
 network 10.2.0.0 0.0.255.255 area 2

! Configure Area 2 as totally stubby area (no-summary)
 area 2 stub no-summary

! Apply prefix-list outbound filtering on Area 2
 area 2 filter-list prefix BLOCK-PREFIX out
!

end
